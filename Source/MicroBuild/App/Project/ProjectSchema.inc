/*
MicroBuild
Copyright (C) 2016 TwinDrills

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

// ---------------------------------------------------------------------------
// General use enums.
// ---------------------------------------------------------------------------
START_ENUM(EOutputType)
	ENUM_KEY(ConsoleApp)
	ENUM_KEY(Executable)
	ENUM_KEY(StaticLib)
	ENUM_KEY(DynamicLib)
END_ENUM()

START_ENUM(EOptimizationLevel)
	ENUM_KEY(None)
	ENUM_KEY(Debug)
	ENUM_KEY(PreferSpeed)
	ENUM_KEY(PreferSize)
	ENUM_KEY(Full)
END_ENUM()

START_ENUM(ECharacterSet)
	ENUM_KEY(Default)
	ENUM_KEY(Unicode)
	ENUM_KEY(MBCS)
END_ENUM()

START_ENUM(EPlatformToolset)
	ENUM_KEY(Default)

	// C++ Platforms
	ENUM_KEY(v140)
	ENUM_KEY(v140_xp)

	// DotNet
	ENUM_KEY(DotNet_2_0)
	ENUM_KEY(DotNet_3_0)
	ENUM_KEY(DotNet_3_5)
	ENUM_KEY(DotNet_4_0)	
	ENUM_KEY(DotNet_4_5)	
	ENUM_KEY(DotNet_4_5_1)
	ENUM_KEY(DotNet_4_5_2)
	ENUM_KEY(DotNet_4_6)	
END_ENUM()

START_ENUM(EWarningLevel)
	ENUM_KEY(Default)
	ENUM_KEY(None)
	ENUM_KEY(Low)
	ENUM_KEY(Medium)
	ENUM_KEY(High)
	ENUM_KEY(Verbose)
END_ENUM()

// ---------------------------------------------------------------------------
// Project
// ---------------------------------------------------------------------------
START_OPTION(
	std::string,
	Project,
	Name,
	"Name of project, used for output file and workspace descriptions."
)
OPTION_RULE_REQUIRED()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Project,
	Group,
	"Location in the workspace file of this project, allows nesting of projects "
	"within workspaces that support it. Can be multiple layers deep, delimate "
	"as per a normal path, eg: ThirdParty/Libraries"
)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Project,
	ShouldBuild,
	"Determines if the project should be built, use in conjunction with if "
	"statements to disable building projects in different configurations."
)
OPTION_RULE_DEFAULT(true)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Project,
	ShouldDeploy,
	"Determines if the project should be deployed, use in conjunction with if "
	"statements to disable building projects in different configurations."
)
OPTION_RULE_DEFAULT(true)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Project,
	Location,
	"Output folder that project files are generated in."
)
OPTION_RULE_REQUIRED()
OPTION_RULE_ABSOLUTE_PATH()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	EOutputType,
	Project,
	OutputType,
	"Defines the type of output generated by building the project."
)
OPTION_RULE_REQUIRED()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	Project,
	OutputName,
	"Basename of output file."
)
OPTION_RULE_REQUIRED()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	Project,
	OutputExtension,
	"Extension of output file."
)
OPTION_RULE_REQUIRED()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Project,
	IntermediateDirectory,
	"Directory that intermediate object files are stored in during build."
)
OPTION_RULE_REQUIRED()
OPTION_RULE_ABSOLUTE_PATH()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Project,
	OutputDirectory,
	"Directory that build artifacts are output to."
)
OPTION_RULE_REQUIRED()
OPTION_RULE_ABSOLUTE_PATH()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	ELanguage,
	Project,
	Language,
	"Language this project is written in. Determines compiler to use."
)
OPTION_RULE_REQUIRED()
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	ELanguageVersion,
	Project,
	LanguageVersion,
	"What language/standard version to compile against."
)
OPTION_RULE_DEFAULT(ELanguageVersion::Default)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	EPlatformSubSystem,
	Project,
	Subsystem,
	"Determines what platform subsystem should be compiled against "
	"(winrt/native/etc)."
)
OPTION_RULE_DEFAULT(EPlatformSubSystem::Native)
END_OPTION()


// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	Project,
	RootNamespace,
	"Root namespace for the project, primarily used in .net projects."
)
OPTION_RULE_DEFAULT(std::string("$(Project.Name)"))
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Project,
	Directory,
	"Automatically defined to the directory the project file is contained in."
)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Project,
	File,
	"Automatically defined to the path to the project file."
)
END_OPTION()

// ---------------------------------------------------------------------------
// Dependencies
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	std::string,
	Dependencies,
	Dependency,
	"Name of projects this project is dependent on, they will be built before "
	"this project is built."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// Libraries
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	Platform::Path,
	Libraries,
	Library,
	"Filename or path to library that should be linked to the output."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// References
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	Platform::Path,
	References,
	Reference,
	"Assembly referenced by project, used primarily for .NET projects."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// Files
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	Platform::Path,
	Files,
	File,
	"Location of files to include in project. Can contain wildcards (*) "
	"and recursive wildcards (**)."
)
OPTION_RULE_REQUIRED()
OPTION_RULE_EXPAND_PATH_WILDCARDS(true)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// Virtual Paths
// ---------------------------------------------------------------------------
START_KEY_VALUE_ARRAY_OPTION(
	VirtualPaths,
	"Defines a key-value pair, with the value being a path pattern to match "
	"project files against, and the key being a virtual path that the file "
	"will be placed under in the output project file. In the virtual path * "
	"will be expanded to the matched project path, explicitly provided path "
	"segments in the path pattern will be exluded from the expansion."
)
END_KEY_VALUE_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// Build
// ---------------------------------------------------------------------------

START_OPTION(
	EOptimizationLevel,
	Build,
	OptimizationLevel,
	"Defines how heavily the project should be optimization, and what kind of "
	"optimizations should be performed."
)
OPTION_RULE_DEFAULT(EOptimizationLevel::Full)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	ECharacterSet,
	Build,
	CharacterSet,
	"Defines when character set to use for string literals / standard library."
)
OPTION_RULE_DEFAULT(ECharacterSet::Default)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	EPlatformToolset,
	Build,
	PlatformToolset,
	"Which platform toolset to use for complication, valid values depend on "
	"the target ide project files are being generated for."
)
OPTION_RULE_DEFAULT(EPlatformToolset::Default)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Build,
	PrecompiledHeader,
	"Path to file to use as a precompiled header for the project."
)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	Build,
	PrecompiledSource,
	"Source file that accompanies the precompiled header file."
)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	EWarningLevel,
	Build,
	WarningLevel,
	"Determines what level of verbosity warnings should be emitted during build."
)
OPTION_RULE_DEFAULT(EWarningLevel::Default)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	Build,
	LinkerArguments,
	"Arguments passed to the linker without transformation."
)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	Build,
	CompilerArguments,
	"Arguments passed to the compiler without transformation."
)
END_OPTION()

// ---------------------------------------------------------------------------
// Defines
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	std::string,
	Defines,
	Define,
	"Preprocessor defines to pass into the compiler."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// DisabledWarnings
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	std::string,
	DisabledWarnings,
	DisabledWarning,
	"Disables the specific warning code while compiling."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// Search Paths
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	Platform::Path,
	SearchPaths,
	IncludeDirectory,
	"Defines a directory to look into for include files."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------

START_ARRAY_OPTION(
	Platform::Path,
	SearchPaths,
	LibraryDirectory,
	"Defines a directory to look into for library files."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// ForcedIncludes
// ---------------------------------------------------------------------------
START_ARRAY_OPTION(
	Platform::Path,
	ForcedIncludes,
	ForcedInclude,
	"Defines a file to force the compiler to include at the start of all files."
)
END_ARRAY_OPTION()

// ---------------------------------------------------------------------------
// Flags
// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	CompilerWarningsFatal,
	"If true all compiler warnings will abort the build."
)
OPTION_RULE_DEFAULT(false)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	LinkerWarningsFatal,
	"If true all linker warnings will abort the build."
)
OPTION_RULE_DEFAULT(false)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	RuntimeTypeInfo,
	"Determines if runtime type information should be generated."
)
OPTION_RULE_DEFAULT(true)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	GenerateDebugInformation,
	"Determines if debugging information (symbols) should be generated."
)
OPTION_RULE_DEFAULT(true)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	LinkTimeOptimization,
	"Determines if link time optimization should be applied to the build."
)
OPTION_RULE_DEFAULT(false)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	Exceptions,
	"Determines if exceptions should be available in this build."
)
OPTION_RULE_DEFAULT(true)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	StaticRuntime,
	"Determines if the runtime library should be statically linked."
)
OPTION_RULE_DEFAULT(false)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	Prefer32Bit,
	"Determines if dotnet AnyCpu projects should prefer 32bit compilation."
)
OPTION_RULE_DEFAULT(false)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	bool,
	Flags,
	AllowUnsafeCode,
	"Determines if dotnet projects permit unsafe code."
)
OPTION_RULE_DEFAULT(false)
END_OPTION()


// ---------------------------------------------------------------------------
// WinRT
// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	WinRT,
	Locale,
	"Determines the default locale of the project (used for app packaging)."
)
OPTION_RULE_DEFAULT(std::string("en-US"))
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	WinRT,
	PlatformVersion,
	"Version of the platform to compile for. Mainly used for WinRT."
)
OPTION_RULE_DEFAULT(std::string("10.0.10586.0"))
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	std::string,
	WinRT,
	PlatformMinimumVersion,
	"Minimum version of the platform this project should compile for. "
	"Mainly used for WinRT."
)
OPTION_RULE_DEFAULT(std::string("10.0.10240.0"))
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	WinRT,
	PackageSigningKey,
	"Path to signing key to use when build app packages."
)
END_OPTION()

// ---------------------------------------------------------------------------

START_OPTION(
	Platform::Path,
	WinRT,
	Manifest,
	"Path to the package manifest file."
)
END_OPTION()

// ---------------------------------------------------------------------------
// Package References
// ---------------------------------------------------------------------------
START_KEY_VALUE_ARRAY_OPTION(
	Packages,
	"Defines a key-value pair, with the key being a package name and the value "
	"being the verison of the package. Used primarily for winrt/nuget package "
	"installation."
)
END_KEY_VALUE_ARRAY_OPTION()