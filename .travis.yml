env:
  global:
   # Coverity Key
   - secure: "bHLULty/2eR7VN17nNJaTxHxmxU378mRDUcrWCrPt5Ww3ItPjbUv/sYNShn7NpsnpQQF16zpU2qqLUKyH2M3XieyJ3QJRNqMh7s6MXRKSfLOlrJpGvoL+uaktu46cxaXkdIiCAqYDSlW19UQECJ9x36UP9qI0tCP9OcjTi8DQBQu9xFKv5nfhnNlna7lufGnzzy3WtbA0X0Zq+cI2GBgu1IgGoyahDLW+CKlJ11WN1vCVWRogHdlZJ8FfJBwQ1cIQlXrdSZ6Y+9Kmh2LfiJCJmeFY1+7Z2mf1fHS7UJiL/YD7d1tRMN5Baitpg6+tehnyt+3QHqVv6+mUJD6ic5X95+7jDzle2HyH6X0Yf33tozTQUe8BXXsDTyz03vQCdAPHv8Bjk8BLicsf9VbhGrrjpQ9hvMC3g1Rx/7y8Haf8iees6SUwOh1RW36hNRANx/jnJOn1iVsCp9u5HNImlOrLQluSl2HB0ep+p2woQVZs2c536h66NDTf0qY6Q8Ctz8UPYE0HNcaeXVijVFdTDrt+tfVEAZvbGgZeue95hJfwAnQDcMXQE163ODiaWZvkVTR1tnK8TfOVsBBmlWkbEKcLNfy5JEQIpPDx01mJzt0wb95605rBbW11LBPCObhVB6CfBDr7ZnzTYEcSGy+OjSnf4Ul+NxfG9Ski8RJsijobMs="
language: cpp
osx_image: xcode8
os:
  - linux
#  - osx
branches:
  only:
  - master
compiler:
  - gcc
sudo: required
install:
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then export CXX="g++-6" CC="gcc-6"; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-6 90; fi
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - gcc-6
    - g++-6
    - gcc-multilib
    - g++-multilib
    - gcc-6-multilib
    - g++-6-multilib	
    - linux-libc-dev
script: 
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then cd ./Build/Automation/Linux; fi
  - if [ "$TRAVIS_OS_NAME" == "osx" ]; then cd ./Build/Automation/MacOS; fi
  - ./GenerateBootstrap.sh
  - ./Build.sh
  - cd ./../../../
after_success: 
  - git config --global user.email "buildserver@programmingbytim.com"
  - git config --global user.name "Build Server"
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then cd ./Build/Automation/Linux; fi
  - if [ "$TRAVIS_OS_NAME" == "osx" ]; then cd ./Build/Automation/MacOS; fi
  - ./GitAddArtifacts_x64.sh
  - ./GitAddArtifacts_x86.sh 
  - cd ./../../../  
  - git checkout $TRAVIS_BRANCH
  - git pull --no-edit --no-commit
  - git commit -m "[ci skip] Automated Build (Travis build $TRAVIS_BUILD_NUMBER)."
  - git push "https://TLeonardUK:$GITHUB_TOKEN@github.com/TLeonardUK/MicroBuild.git" --all --quiet 
